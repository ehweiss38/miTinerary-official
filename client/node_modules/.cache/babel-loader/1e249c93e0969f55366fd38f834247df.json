{"ast":null,"code":"import _regeneratorRuntime from\"/Users/ethan/Desktop/Code/miTinerary-official/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/ethan/Desktop/Code/miTinerary-official/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _createForOfIteratorHelper from\"/Users/ethan/Desktop/Code/miTinerary-official/client/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";import _slicedToArray from\"/Users/ethan/Desktop/Code/miTinerary-official/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from\"react\";import Sidebar from\"./components/Sidebar\";import AttractionsHome from\"./components/Attractions/AttractionsHome\";import MapContainer from\"./components/Map/MapContainer\";import axios from\"axios\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var calcDistance=require('./components/calcDistance/calcDistance');var Main=function Main(props){var _useState=useState(null),_useState2=_slicedToArray(_useState,2),selected=_useState2[0],setSelected=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),visit=_useState4[0],setVisit=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),message=_useState6[0],setMessage=_useState6[1];var _useState7=useState(null),_useState8=_slicedToArray(_useState7,2),activeTrip=_useState8[0],setActiveTrip=_useState8[1];var _useState9=useState([]),_useState10=_slicedToArray(_useState9,2),tripArr=_useState10[0],setTripArr=_useState10[1];var _useState11=useState(null),_useState12=_slicedToArray(_useState11,2),directions=_useState12[0],setDirections=_useState12[1];var _useState13=useState(null),_useState14=_slicedToArray(_useState13,2),mainDisDur=_useState14[0],setMain=_useState14[1];useEffect(function(){if(!directions){return;}var arr=[];var _iterator=_createForOfIteratorHelper(directions),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var dir=_step.value;arr.push([dir.routes[0].legs[0].distance.text,dir.routes[0].legs[0].duration.text]);}}catch(err){_iterator.e(err);}finally{_iterator.f();}setMain(arr);return;},[directions]);useEffect(function(){console.log('running',props.trip);if(Array.isArray(props.trip)){setTripArr(props.trip);}else{setTripArr(props.trip.trip);setActiveTrip(props.trip._id);}},[props.trip]);useEffect(function(){if(!activeTrip){return;}_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var synced;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.get(\"https://mitinerary-js.herokuapp.com/select/\".concat(activeTrip));case 2:synced=_context.sent;if(!synced){_context.next=8;break;}console.log('backend synced');return _context.abrupt(\"return\");case 8:console.log('unable to sync');//set up view mode\nreturn _context.abrupt(\"return\");case 10:case\"end\":return _context.stop();}}},_callee);}))();},[activeTrip]);useEffect(function(){setMessage('');},[props.signIn]);var custZoom=tripArr.length?calcDistance(tripArr[0].latitude,tripArr[tripArr.length-1].latitude,tripArr[0].longitude,tripArr[tripArr.length-1].longitude):8;console.log('cZ',custZoom);var save=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var qsTrip,success;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(props.signIn){_context2.next=3;break;}setMessage('To save your trip, please sign in or create an account');return _context2.abrupt(\"return\");case 3:qsTrip=activeTrip?activeTrip:'0';_context2.next=6;return axios.get(\"https://mitinerary-js.herokuapp.com/tripSave/\".concat(props.signIn,\"/\").concat(qsTrip));case 6:success=_context2.sent;if(!success.data){_context2.next=13;break;}console.log('successfully saved');setActiveTrip(success.data);return _context2.abrupt(\"return\");case 13:console.log('saving error');return _context2.abrupt(\"return\");case 15:case\"end\":return _context2.stop();}}},_callee2);}));return function save(){return _ref2.apply(this,arguments);};}();var highlight=function highlight(index){setSelected(index);};var go=function go(bool){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;if(e){e.stopPropagation();}console.log(selected,tripArr);setVisit(bool);};var receiveDisDur=function receiveDisDur(arr){setMain(arr);};var receiveDirections=function receiveDirections(arr){setDirections(arr);};var messageDisp=message?/*#__PURE__*/_jsx(\"h3\",{style:{color:'red'},children:message}):'';if(visit){console.log(tripArr,selected);return/*#__PURE__*/_jsx(\"div\",{className:\"card\",style:{margin:50},children:/*#__PURE__*/_jsx(AttractionsHome,{go:go,loc:tripArr[selected],selected:selected,receiveTrip:props.receiveTrip})});}return/*#__PURE__*/_jsxs(\"div\",{className:\"card background\",style:{margin:50},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"columns\",style:{opacity:1},children:[/*#__PURE__*/_jsx(\"div\",{className:\"column is-three-fifths\",children:!tripArr.length?/*#__PURE__*/_jsx(\"div\",{children:\"Loading...\"}):/*#__PURE__*/_jsx(MapContainer,{selected:selected,tripArr:tripArr,zoom:custZoom,receiveDirections:receiveDirections,directions:directions})}),/*#__PURE__*/_jsx(\"div\",{className:\"column is-two-fifths\",children:/*#__PURE__*/_jsx(Sidebar,{go:go,selected:selected,trip:tripArr,highlight:highlight,disDur:mainDisDur})})]}),/*#__PURE__*/_jsx(\"button\",{className:\"button is-primary buttonPos\",onClick:save,children:\"Save this trip\"}),messageDisp]});};export default Main;","map":{"version":3,"names":["React","useState","useEffect","Sidebar","AttractionsHome","MapContainer","axios","calcDistance","require","Main","props","selected","setSelected","visit","setVisit","message","setMessage","activeTrip","setActiveTrip","tripArr","setTripArr","directions","setDirections","mainDisDur","setMain","arr","dir","push","routes","legs","distance","text","duration","console","log","trip","Array","isArray","_id","get","synced","signIn","custZoom","length","latitude","longitude","save","qsTrip","success","data","highlight","index","go","bool","e","stopPropagation","receiveDisDur","receiveDirections","messageDisp","color","margin","receiveTrip","opacity"],"sources":["/Users/ethan/Desktop/Code/miTinerary-official/client/src/components/display/Main.js"],"sourcesContent":["import React,{useState,useEffect} from \"react\";\nimport Sidebar from \"./components/Sidebar\";\nimport AttractionsHome from \"./components/Attractions/AttractionsHome\";\nimport MapContainer from \"./components/Map/MapContainer\";\nimport axios from \"axios\";\nconst calcDistance=require('./components/calcDistance/calcDistance')\n\nconst Main=(props)=>{\n\n    const [selected,setSelected]=useState(null)\n    const[visit,setVisit]=useState(false)\n    const[message,setMessage]=useState('')\n    const[activeTrip,setActiveTrip]=useState(null)\n    const[tripArr,setTripArr]=useState([])\n    const[directions,setDirections]=useState(null)\n    const [mainDisDur,setMain]=useState(null)\n\n    useEffect(()=>{\n        if(!directions){\n            return\n        }\n        const arr=[]\n        for(let dir of directions){\n            arr.push([dir.routes[0].legs[0].distance.text,dir.routes[0].legs[0].duration.text])\n        }\n        setMain(arr)\n        return\n\n    },[directions])\n\n    useEffect(()=>{\n        console.log('running',props.trip)\n        if(Array.isArray(props.trip)){\n            setTripArr(props.trip)\n        }else{\n            setTripArr(props.trip.trip)\n            setActiveTrip(props.trip._id)\n        }\n    },[props.trip])\n\n    useEffect(()=>{\n        if(!activeTrip){\n            return\n        }\n        (async()=>{\n            const synced=await(axios.get(`https://mitinerary-js.herokuapp.com/select/${activeTrip}`))\n            if(synced){\n                console.log('backend synced')\n                return\n            }else{\n                console.log('unable to sync')\n                //set up view mode\n                return\n            }\n        })()\n    },[activeTrip])\n\n\n    useEffect(()=>{\n        setMessage('')\n    },[props.signIn])\n\n    const custZoom=tripArr.length?calcDistance(tripArr[0].latitude,tripArr[tripArr.length-1].latitude,tripArr[0].longitude,tripArr[tripArr.length-1].longitude):8\n\n    console.log('cZ',custZoom)\n\n    const save=async ()=>{\n        if(!props.signIn){\n            setMessage('To save your trip, please sign in or create an account')\n            return\n        }\n        let qsTrip=activeTrip?activeTrip:'0'\n        const success=await axios.get(`https://mitinerary-js.herokuapp.com/tripSave/${props.signIn}/${qsTrip}`)\n        if(success.data){\n            console.log('successfully saved')\n            setActiveTrip(success.data)\n            return \n        }else{\n            console.log('saving error')\n            return\n        }\n    }\n\n    const highlight=(index)=>{\n        setSelected(index)\n    }\n    const go=(bool,e=false)=>{\n        if(e){\n            e.stopPropagation()\n        }\n        console.log(selected,tripArr)\n        setVisit(bool)\n    }\n\n    const receiveDisDur=(arr)=>{\n        setMain(arr)\n    }\n\n    const receiveDirections=(arr)=>{\n        setDirections(arr)\n    }\n\n    const messageDisp=message?\n    <h3 style={{color:'red'}}>{message}</h3>:''\n\n\n    if(visit){\n        console.log(tripArr,selected)\n        return(\n            <div className=\"card\" style={{margin:50}}>\n                <AttractionsHome go={go} loc={tripArr[selected]} selected={selected} receiveTrip={props.receiveTrip}/>\n            </div>\n        )\n    }\n    return(\n        <div className=\"card background\" style={{margin:50}}>\n            <div className=\"columns\" style={{opacity:1}}>\n                <div className=\"column is-three-fifths\">\n                    {!tripArr.length?\n                    <div>Loading...</div>:\n                    <MapContainer selected={selected} tripArr={tripArr} zoom={custZoom} receiveDirections={receiveDirections} directions={directions}/>\n                    }\n                </div>\n                <div className=\"column is-two-fifths\">\n                    <Sidebar go={go} selected={selected} trip={tripArr} highlight={highlight} disDur={mainDisDur}/>\n                </div>\n            </div>\n            <button className=\"button is-primary buttonPos\"onClick={(save)} >Save this trip</button>\n            {messageDisp}\n        </div>\n    )\n}\n\nexport default Main"],"mappings":"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"},"metadata":{},"sourceType":"module"}