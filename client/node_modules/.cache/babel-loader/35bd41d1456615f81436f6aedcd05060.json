{"ast":null,"code":"import _regeneratorRuntime from\"/Users/ethan/Desktop/Code/miTinerary-official/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/ethan/Desktop/Code/miTinerary-official/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/ethan/Desktop/Code/miTinerary-official/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from'react';import{GoogleMap,MarkerF,DirectionsRenderer}from'@react-google-maps/api';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Map=function Map(props){var _useState=useState(null),_useState2=_slicedToArray(_useState,2),markers=_useState2[0],setMarkers=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),secondaryMarkers=_useState4[0],setSecondary=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),mapDirs=_useState6[0],setMapDirs=_useState6[1];useEffect(function(){console.log('called');var markersArr=props.tripArr.map(function(place){console.log(place);return/*#__PURE__*/_jsx(MarkerF,{position:{lat:place.latitude,lng:place.longitude},icon:{scale:6}},place.name);});setMarkers(markersArr);},[props.tripArr]);useEffect(function(){console.log('running sec',props.tripArr[props.selected]);var secMarkersCollection=[];if(props.selected===null){setSecondary(null);return;}if(props.tripArr[props.selected].hotels){console.log('hotel');var hMarks=[];var list=props.tripArr[props.selected].hotels;for(var hotel in list){hMarks.push(/*#__PURE__*/_jsx(MarkerF,{position:{lat:list[hotel].latitude,lng:list[hotel].longitude},icon:{url:'http://maps.google.com/mapfiles/ms/icons/pink-dot.png'},label:list[hotel].hotel_name},list[hotel].hotel_name));}secMarkersCollection=secMarkersCollection.concat(hMarks);}if(props.tripArr[props.selected].restaurants){var rMarks=[];var _list=props.tripArr[props.selected].restaurants;for(var rest in _list){rMarks.push(/*#__PURE__*/_jsx(MarkerF,{position:{lat:parseFloat(_list[rest].latitude),lng:parseFloat(_list[rest].longitude)},icon:{url:'http://maps.google.com/mapfiles/ms/icons/blue-dot.png'},label:_list[rest].name},_list[rest].name));}secMarkersCollection=secMarkersCollection.concat(rMarks);}if(props.tripArr[props.selected].attractions){var aMarks=[];var _list2=props.tripArr[props.selected].attractions;for(var attr in _list2){aMarks.push(/*#__PURE__*/_jsx(MarkerF,{position:{lat:parseFloat(_list2[attr].latitude),lng:parseFloat(_list2[attr].longitude)},icon:{url:'http://maps.google.com/mapfiles/ms/icons/green-dot.png'},label:_list2[attr].name},_list2[attr].name));}secMarkersCollection=secMarkersCollection.concat(aMarks);}console.log(secMarkersCollection);if(secMarkersCollection.length){setSecondary(secMarkersCollection);}return;},[props.selected]);useEffect(function(){console.log('called');if(props.selected||props.directions){return;}//add abort controller\n_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var dirs,disDur,i,dir,result;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:dirs=[];disDur=[];i=0;case 3:if(!(i<props.tripArr.length-1)){_context.next=12;break;}dir=new window.google.maps.DirectionsService();_context.next=7;return dir.route({origin:{lat:props.tripArr[i].latitude,lng:props.tripArr[i].longitude},destination:{lat:props.tripArr[i+1].latitude,lng:props.tripArr[i+1].longitude},travelMode:window.google.maps.TravelMode.DRIVING});case 7:result=_context.sent;dirs.push(result);case 9:i++;_context.next=3;break;case 12:if(dirs.length===props.tripArr.length-1){console.log('dirs to set',dirs);props.receiveDirections(dirs);}return _context.abrupt(\"return\");case 14:case\"end\":return _context.stop();}}},_callee);}))();},[]);useEffect(function(){if(!props.directions){return;}var loadedDirections=props.directions?props.directions.map(function(dir){return/*#__PURE__*/_jsx(DirectionsRenderer,{directions:dir,polylineOptions:{strokeColor:\"red\",suppressMarkers:true}});}):'';setMapDirs(loadedDirections);},[props.directions]);var loadedMarkers=markers?markers:'';console.log('props',props.directions);var loadedDirections=props.directions?props.directions.map(function(dir){return/*#__PURE__*/_jsx(DirectionsRenderer,{directions:dir,polylineOptions:{strokeColor:\"red\",suppressMarkers:true}});}):'';console.log('loaded',loadedDirections);var current=props.selected||props.selected===0?{lat:props.tripArr[props.selected].latitude,lng:props.tripArr[props.selected].longitude,zoom:12}:{lat:props.tripArr[Math.floor(props.tripArr.length/2)].latitude,lng:props.tripArr[Math.floor(props.tripArr.length/2)].longitude,zoom:props.zoom};return/*#__PURE__*/_jsxs(GoogleMap,{zoom:current.zoom,center:{lat:current.lat,lng:current.lng},mapContainerClassName:\"map-container\",options:{fullScreenControl:false},children:[loadedMarkers,mapDirs,secondaryMarkers]});};export default Map;","map":{"version":3,"names":["React","useState","useEffect","GoogleMap","MarkerF","DirectionsRenderer","Map","props","markers","setMarkers","secondaryMarkers","setSecondary","mapDirs","setMapDirs","console","log","markersArr","tripArr","map","place","lat","latitude","lng","longitude","scale","name","selected","secMarkersCollection","hotels","hMarks","list","hotel","push","url","hotel_name","concat","restaurants","rMarks","rest","parseFloat","attractions","aMarks","attr","length","directions","dirs","disDur","i","dir","window","google","maps","DirectionsService","route","origin","destination","travelMode","TravelMode","DRIVING","result","receiveDirections","loadedDirections","strokeColor","suppressMarkers","loadedMarkers","current","zoom","Math","floor","fullScreenControl"],"sources":["/Users/ethan/Desktop/Code/miTinerary-official/client/src/components/display/components/Map/Map.js"],"sourcesContent":["import React,{useState,useEffect} from 'react';\nimport {GoogleMap,MarkerF,DirectionsRenderer} from '@react-google-maps/api';\n\n\nconst Map=(props)=>{\n    const[markers,setMarkers]=useState(null)\n    const [secondaryMarkers,setSecondary]=useState(null)\n    const [mapDirs,setMapDirs]=useState(null)\n\n\n    useEffect(()=>{\n        console.log('called')\n        const markersArr=props.tripArr.map((place)=>{\n            console.log(place)\n            return <MarkerF position={{lat:place.latitude,lng:place.longitude}} icon={{scale:6}}key={place.name}/>\n        })\n        setMarkers(markersArr)\n    },[props.tripArr])\n\n    useEffect(()=>{\n        console.log('running sec',props.tripArr[props.selected])\n        let secMarkersCollection=[]\n        if(props.selected===null){\n            setSecondary(null)\n            return\n        }\n        if(props.tripArr[props.selected].hotels){\n            console.log('hotel')\n            const hMarks=[]\n            const list=props.tripArr[props.selected].hotels\n            for(let hotel in list){\n                hMarks.push(<MarkerF position={{lat:list[hotel].latitude,lng:list[hotel].longitude}} icon={{url:'http://maps.google.com/mapfiles/ms/icons/pink-dot.png'}}label={list[hotel].hotel_name}key={list[hotel].hotel_name}/>)\n            }\n            secMarkersCollection=secMarkersCollection.concat(hMarks)\n        }\n        if(props.tripArr[props.selected].restaurants){\n            const rMarks=[]\n            const list=props.tripArr[props.selected].restaurants\n            for(let rest in list){\n                rMarks.push(<MarkerF position={{lat:parseFloat(list[rest].latitude),lng:parseFloat(list[rest].longitude)}} icon={{url:'http://maps.google.com/mapfiles/ms/icons/blue-dot.png'}} label={list[rest].name}key={list[rest].name}/>)\n            }\n            secMarkersCollection=secMarkersCollection.concat(rMarks)\n        }\n        if(props.tripArr[props.selected].attractions){\n            const aMarks=[]\n            const list=props.tripArr[props.selected].attractions\n            for (let attr in list){\n                aMarks.push(<MarkerF position={{lat:parseFloat(list[attr].latitude),lng:parseFloat(list[attr].longitude)}} icon={{url:'http://maps.google.com/mapfiles/ms/icons/green-dot.png'}} label={list[attr].name}key={list[attr].name}/>)\n            }\n            secMarkersCollection=secMarkersCollection.concat(aMarks)\n        }\n        console.log(secMarkersCollection)\n        if(secMarkersCollection.length){\n            setSecondary(secMarkersCollection)\n        }\n        return\n    },[props.selected])\n\n    useEffect(()=>{\n        console.log('called')\n        if(props.selected||props.directions){\n            return\n        }\n        //add abort controller\n        (async()=>{\n            const dirs=[]\n            const disDur=[]\n            for(let i=0;i<props.tripArr.length-1;i++){\n                const dir= new window.google.maps.DirectionsService()\n                const result=await dir.route({\n                    origin: {lat:props.tripArr[i].latitude,lng:props.tripArr[i].longitude},\n                    destination: {lat:props.tripArr[i+1].latitude,lng:props.tripArr[i+1].longitude},\n                    travelMode: window.google.maps.TravelMode.DRIVING\n                })\n                dirs.push(result)\n            }\n            if(dirs.length===props.tripArr.length-1){\n                console.log('dirs to set',dirs)\n                props.receiveDirections(dirs)\n            }\n            return\n        })()\n    },[])\n    useEffect(()=>{\n        if(!props.directions){\n            return\n        }\n        const loadedDirections=props.directions?props.directions.map(dir=>{\n            return <DirectionsRenderer directions={dir} polylineOptions={{strokeColor: \"red\",suppressMarkers:true}}/>\n        }):''\n        setMapDirs(loadedDirections)\n    },[props.directions])\n\n    const loadedMarkers=markers?markers:''\n\n    console.log('props',props.directions)\n    const loadedDirections=props.directions?props.directions.map(dir=>{\n        return <DirectionsRenderer directions={dir} polylineOptions={{strokeColor: \"red\",suppressMarkers:true}}/>\n    }):''\n    console.log('loaded',loadedDirections)\n    let current=props.selected||props.selected===0?\n        {lat:props.tripArr[props.selected].latitude,lng:props.tripArr[props.selected].longitude,zoom:12}:\n        {lat:props.tripArr[Math.floor(props.tripArr.length/2)].latitude,lng:props.tripArr[Math.floor(props.tripArr.length/2)].longitude,zoom:props.zoom}\n    return(\n        <GoogleMap zoom={current.zoom} center={{lat:current.lat,lng:current.lng}} mapContainerClassName=\"map-container\" options={{fullScreenControl:false}}>\n            {loadedMarkers}\n            {mapDirs}\n            {secondaryMarkers}\n        </GoogleMap>\n    )\n}\n\nexport default Map"],"mappings":"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"},"metadata":{},"sourceType":"module"}